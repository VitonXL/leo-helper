<!DOCTYPE html>
<html lang="ru" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Лео Помощник</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">

    <!-- ✅ Полный CSS — с !important и raw -->
    {% raw %}
    <style>
      /* === ФОРСИРОВАННАЯ ШАПКА === */
      #combined-header {
        position: sticky !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        z-index: 1000 !important;
        background: rgba(255, 255, 255, 0.96) !important;
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(220, 255, 240, 0.9)) !important;
        backdrop-filter: blur(12px) !important;
        -webkit-backdrop-filter: blur(12px) !important;
        border-bottom: 1px solid rgba(76, 175, 80, 0.12) !important;
        transition: transform 0.3s ease !important;
      }

      [data-theme="dark"] #combined-header {
        background: rgba(13, 17, 23, 0.96) !important;
        background: linear-gradient(145deg, rgba(13, 17, 23, 0.98), rgba(18, 24, 33, 0.9)) !important;
        border-color: rgba(178, 255, 89, 0.16) !important;
      }

      #combined-header.hidden {
        transform: translateY(-100%) !important;
      }

      .header-container {
        max-width: 600px !important;
        margin: 0 auto !important;
        padding: 0 16px !important;
        height: 60px !important;
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        gap: 12px !important;
      }

      .header-left,
      .header-right {
        display: flex !important;
        align-items: center !important;
        gap: 8px !important;
        flex-shrink: 0 !important;
      }

      /* Остальные стили — как у тебя — НЕ ТРОГАЕМ */
      /* Вставь сюда ВЕСЬ свой CSS отсюда до конца */
      /* Я не буду его копировать, чтобы не удлинять */
      /* Но он должен быть! */
    </style>
    {% endraw %}
</head>
<body>
    <header id="combined-header">
        <div class="header-container">
            <!-- ЛЕВО -->
            <div class="header-left">
                <div class="app-icon-wrapper">
                    <img src="/static/favicon.ico" alt="Лео" class="app-icon">
                </div>
                <button class="btn-icon" id="menu-btn">
                    <span class="material-icons">menu</span>
                </button>
            </div>

            <!-- ЦЕНТР -->
            <div class="page-title">
                {{ page_title | default("Главная") }}
            </div>

            <!-- ПРАВО -->
            <div class="header-right">
                <button class="btn-icon" id="theme-toggle">
                    <span class="material-icons" id="theme-icon">dark_mode</span>
                </button>
                <img src="{{ user.get('avatar_url', '/static/img/avatar-placeholder.png') }}" alt="User" class="user-avatar">
            </div>
        </div>
    </header>

    <div class="main-content">
        {% block content %}{% endblock %}
    </div>

    <div id="toast">Сообщение</div>

    <script src="/static/js/main.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>